<!DOCTYPE html>
<html>
    <head>
            <!-- skapad utifrån http://www.jessicaschillinger.us/2017/blog/print-repeating-header-browser/ -->
            <title>Planeringsunderlag försäljning</title>
            <meta charset="utf-8">
            <meta name="viewport" content="width=device-width, initial-scale=1">
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css">
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"></script>
            <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.min.js"></script>

            <style>


            table.report-container {
                page-break-after:always;
            }
            thead.report-header {
                display:table-header-group;
            }
            tfoot.report-footer {
                display:table-footer-group;
            }

            @media print {
                .row.pgaBreak {page-break-after: always;}

            }
            </style>
    </head>

<body>
    


    <div class="container">
        <div class="row pgaBreak" id="summary_1">
            <div class="col">
                <div class="jumbotron">
                    <div>
                        <img src="https://www.sveaskog.se/static/dist/img/sveaskog-logo.svg" alt="Sveaskog" style="padding:5px;" width="200px" align="left">    
                    </div>
                    <div>
                        <h1 align="center">Planeringsunderlag försäljning</h1>
                        <p align="center">Sveaskog säljer Lorem ipsum dolor sit amet con</p>    
                    </div>
                </div>
                <div>
                    <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Velit, iusto nemo et, molestias vitae quisquam rem vel veniam tenetur rerum facere blanditiis qui a quam quo perferendis, sint incidunt libero.</p>
                    <div class="row">
                        <div class="col-12">
                            <h3 align="center">Ägoslag</h3>
                        </div>  
                        <div class="col-4 d-flex align-items-center justify-content-center">
                            <table class="table-striped table-bordered" id="agoslagTabell">
                                <tr>
                                    <th>Ägoslag</th>
                                    <th>Areal</th>
                                </tr>

                            </table>                        
                        </div>
                        <div class="col-8 d-flex align-items-center justify-content-center">
                            <div class="chart-container" style="width:500px">
                                <canvas id="agoslagChart"></canvas>
                            </div>    
                        </div>    
                        
                    </div>
                    <div class="row">
                            <div class="col-12">
                                <h3 align="center">Huggningsklass</h3>
                            </div>  
                        <div class="col-4 d-flex align-items-center justify-content-center">
                            <table class="table-striped table-bordered" id="hklTabell">
                                <tr>
                                    <th>Huggningsklass</th>
                                    <th>Areal</th>
                                    <th>Volym</th>
                                </tr>

                            </table>                        
                        </div>
                        <div class="col-8 d-flex align-items-center justify-content-center">
                            <div class="chart-container" style="width:500px">
                                <canvas id="hklassChart"></canvas>
                            </div>    
                        </div>
                    </div>
                </div>
                <div class="row">
                        <div class="col-12">
                            <h3 align="center">Åldersklass</h3>
                        </div>  
                    <div class="col-4 d-flex align-items-center justify-content-center">
                        <table class="table-striped table-bordered" id="alderTabell">
                            <tr>
                                <th>Åldersklass</th>
                                <th>Areal</th>
                                <th>Volym</th>
                            </tr>

                        </table>                        
                    </div>
                    <div class="col-8 d-flex align-items-center justify-content-center">
                        <div class="chart-container" style="width:500px">
                            <canvas id="alderArealChart"></canvas>
                            <canvas id="alderVolymChart"></canvas>
                        </div>    
                    </div>
                </div>
            </div>
        </div>

        <div class="row pgaBreak" id="avd">
            <div class="col">
                <table class="report-container table-striped" id="avdTabell">
                    <thead class="report-header">
                        <tr>
                            <div class="report-header-cell">
                                <div class="header-info">
                                    <tr>
                                        <th colspan="16">
                                            <div class="jumbotron">
                                                <img src="https://www.sveaskog.se/static/dist/img/sveaskog-logo.svg" alt="Sveaskog" style="padding:5px;" width="200px" align="left">    
                                                <h1 align="center">Planeringsunderlag försäljning</h1>
                                                <p align="center">Sveaskog säljer Lorem ipsum dolor sit amet con</p>    
                                            </div>
                                        </th>
                                    </tr>
                                    
                                    <tr class="table table-bordered">
                                        <th colspan="9">Avd</th>
                                        
                                        
                                        <th colspan="5">m3sk/ha</th>
                                        <th colspan="2">Areal, ha</th>
                                        <!--<th colspan="6"></th>-->
                                    </tr>
                                    
                                    <tr class="table table-bordered">
                                        <th>Nr</th>
                                        <th>Bet.</th>
                                        <th>Ägoslag</th>
                                        <th>Målkl.</th>
                                        <th>Hkl</th>

                                        <th>Ålder</th>
                                        <th>SI</th>
                                        <th>TGBÖ</th>
                                        <th>m3sk</th>
                                        <th>Tot</th>
                                        <th>T</th>
                                        <th>G</th>
                                        <th>B</th>
                                        <th>Övr.</th>
                                        <th>Netto</th>
                                        <th>Avdr.</th>
                                        
                                       </tr>
                                </div>
                            </div>
                        </tr>
                    </thead>
                    <tfoot class="report-footer">
                        <tr>
                            <div class="report-footer-cell">
                                <div class="footer-info">
                                    <td colspan="16">
                                        <p>
                                            En beskrivning av huggningsklass tex
                                            Lorem ipsum dolor sit, amet consectetur adipisicing elit. Voluptate cumque ab sit veritatis repellat fugiat tempore error esse, inventore soluta autem, delectus repudiandae? Temporibus magnam possimus voluptatem in, blanditiis quis!
                                        </p>
                                    </td>
                                </div>
                            </div>
                        </tr>
                    </tfoot>
                    <tbody class="report-content">
                        <tr>
                            <td class="report-content-cell">
                                <div class="main" >
                                    <!-- tabelldata avdelning från json-fil -->
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="row pgaBreak" id="trad">
            <div class="col">
                <table class="report-container table-striped" id="tradTabell">
                    <thead class="report-header">
                        <tr>
                            <div class="report-header-cell">
                                <div class="header-info">
                                    <tr>
                                        <th colspan="14">
                                            <div class="jumbotron">
                                                <img src="https://www.sveaskog.se/static/dist/img/sveaskog-logo.svg" alt="Sveaskog" style="padding:5px;" width="200px" align="left">    
                                                <h1 align="center">Planeringsunderlag försäljning</h1>
                                                <p align="center">Sveaskog säljer Lorem ipsum dolor sit amet con</p>    
                                            </div>                                           
                                        </th>
                                    </tr>
                                    <tr class="table table-bordered">
                                        <th>Avd</th>
                                        <th colspan="3">Trädskikt</th>
                                        <th colspan="2">m3sk per</th>
                                        <th colspan="9"></th>
                                    </tr>
                                    <tr class="table table-bordered">
                                        <th>Nr</th>
                                        <th>Typ</th>
                                        <th>Trsl</th>
                                        <th>Ålder</th>
                                        <th>Ha</th>
                                        <th>Avd</th>
                                        <th>Gy</th>
                                        <th>DGv</th>
                                        <th>HGv</th>
                                        <th>St/Ha</th>
                                        <th>Andel</th>
                                        <th>Ha</th>
                                        <th>Målklass</th>
                                        <th>Hkl</th>
                                    </tr>
                                </div>
                            </div>
                        </tr>
                    </thead>
                    <tfoot class="report-footer">
                        <tr>
                            <div class="report-footer-cell">
                                <div class="footer-info">
                                    <td colspan="16">
                                        <p>
                                            En beskrivning av något annat
                                            Voluptate cumque ab sit veritatis repellat fugiat tempore error esse, inventore soluta autem, delectus repudiandae? Temporibus magnam possimus voluptatem in, blanditiis quis!
                                        </p>
                                    </td>
                                </div>
                            </div>
                        </tr>
                    </tfoot>
                    <tbody class="report-content">
                        <tr>
                            <td class="report-content-cell">
                                <div class="main">
                                    <!--tabelldata trädlsg från json fil-->
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>





    <script>



        $(document).ready(function(){

            
            $.getJSON("Data/data.json", function(data){
                
                //---------------Skapar tabelerna för Avdelning och Trädslag------------------------------------
                            
                var avd_data = '';
                var trad_data = '';

                $.each(data.Avd, function(key, value){
                    //console.log(value.Lopnummer)
                    avd_data += '<tr>';
                    avd_data += '<td>' +value.Lopnummer+ '</td>';
                    avd_data += '<td>' +value.Beteckning+ '</td>';
                    avd_data += '<td>' +value.Agoslag+ '</td>';
                    avd_data += '<td>' +value.Malklass+ '</td>';
                    avd_data += '<td>' +value.Huggningsklass+ '</td>';
                    avd_data += '<td>' +value.Alder+ '</td>';
                    avd_data += '<td>' +value.SI+ '</td>';
                    avd_data += '<td>' +value.TGBÖ+ '</td>';
                    avd_data += '<td>' +value.VolymSkogPerAvdelning+ '</td>';
                    avd_data += '<td>' +value.VolymSkogPerHaTot+ '</td>';
                    avd_data += '<td>' +value.VolymSkogPerHaTall+ '</td>';
                    avd_data += '<td>' +value.VolymSkogPerHaGran+ '</td>';
                    avd_data += '<td>' +value.VolymSkogPerHaBjörk+ '</td>';
                    avd_data += '<td>' +value.VolymSkogPerHaÖvrigt+ '</td>';
                    avd_data += '<td>' +value.Nettoarel+ '</td>';
                    avd_data += '<td>' +value.ArealavdragSumma+ '</td>';
                    avd_data += '</tr>';
                    //console.log(value.Trad);
                    var trad = value.Trad;
                    var avdLopnr = value.Lopnummer;
                    var avdNettoareal = value.Nettoarel;
                    var avdMalklass = value.Malklass;
                    var avdHuggningsklass = value.Huggningsklass;
                    $.each(trad, function(key, value){
                        //console.log(value);
                        //console.log(avdLopnr);
                        trad_data += '<tr>';
                        trad_data += '<td>' +avdLopnr+ '</td>';
                        trad_data += '<td>' +value.Tradskikt_Typ+ '</td>';
                        trad_data += '<td>' +value.Tradslag+ '</td>';
                        trad_data += '<td>' +value.Alder+ '</td>';
                        trad_data += '<td>' +value.VolymSkogPerHa+ '</td>';
                        trad_data += '<td>' +value.VolymSkogPerAvdelning+ '</td>';
                        trad_data += '<td>' +value.Grundyta+ '</td>';
                        trad_data += '<td>' +value.DiameterGv+ '</td>';
                        trad_data += '<td>' +value.HojdGv+ '</td>';
                        trad_data += '<td>' +value.StammarPerHa+ '</td>';
                        trad_data += '<td>' +value.Andel+ '</td>';
                        trad_data += '<td>' +avdNettoareal+ '</td>';
                        trad_data += '<td>' +avdMalklass+ '</td>';
                        trad_data += '<td>' +avdHuggningsklass+ '</td>';
                        trad_data += '</tr>';
                    });
                });

                $('#avdTabell').append(avd_data);
                //console.log(avd_data)
                $('#tradTabell').append(trad_data);
                //console.log(trad_data)

                //----------------skapar Ägoslagssammanfattning------------------------------------------
                //console.log(analys_data.AgoslagStat);
                makeAgoslagBarDiagram(data.AgoslagStat, 'agoslagChart');

                function makeAgoslagBarDiagram(stat, htmlCanvas){
                    //Ägoslagsdiagram
                    var list = [];
                    var areal = [];
                    var farg = [];
                    var tabell = '';
                    $.each(stat, function(key, value){
                        list.push(value.Agoslag);
                        areal.push(value.Areal);
                        farg.push(value.FillColor)
                        //till tabell
                        tabell += '<tr>';
                        tabell += '<td>' +value.Agoslag+ '</td>'
                        tabell += '<td>' +value.Areal+ '</td>'
                        tabell += '</tr>';

                    });
                    $('#agoslagTabell').append(tabell);
                    var ctx = document.getElementById(htmlCanvas);
                    var myChart = new Chart(ctx, {
                        //type: 'bar',
                        type: 'horizontalBar',
                        data: {
                            labels: list,
                            datasets: [
                                    { 
                                        data: areal,
                                        label: 'Areal',
                                        backgroundColor: farg,
                                        borderColor: "#000000",
                                        borderWidth: 1,
                                    }
                                    ]
                                }
                    });                
                }


                //----------------skapar Huggningsklasssammanfattning------------------------------------------
                //console.log(analys_data.AgoslagStat);
                makeHklBarDiagram(data.HklStat, 'hklassChart');

                function makeHklBarDiagram(stat, htmlCanvas){
                    //Ägoslagsdiagram
                    var list = [];
                    var areal = [];
                    var farg = [];
                    var tabell = '';
                    $.each(stat, function(key, value){
                        list.push(value.Huggningsklass);
                        areal.push(value.Areal);
                        farg.push(value.FillColor)
                        //till tabell
                        tabell += '<tr>';
                        tabell += '<td>' +value.Huggningsklass+ '</td>'
                        tabell += '<td>' +value.Areal+ '</td>'
                        tabell += '<td>' +value.Volym+ '</td>'
                        tabell += '</tr>';

                    });
                    $('#hklTabell').append(tabell);
                    var ctx = document.getElementById(htmlCanvas);
                    var myChart = new Chart(ctx, {
                        //type: 'bar',
                        type: 'horizontalBar',
                        data: {
                            labels: list,
                            datasets: [
                                    { 
                                        data: areal,
                                        label: 'Areal',
                                        backgroundColor: farg,
                                        borderColor: "#000000",
                                        borderWidth: 1,
                                    }
                                    ]
                                }
                    });                
                }

                //----------------skapar Huggningsklasssammanfattning------------------------------------------
                //console.log(analys_data.AgoslagStat);
                makeAlderArealBarDiagram(data.AlderStat, 'alderArealChart');
                makeAlderVolymBarDiagram(data.AlderStat, 'alderVolymChart');

                function makeAlderArealBarDiagram(stat, htmlCanvas){
                    //Alderdiagram
                    var list = [];
                    var areal = [];
                    var farg = [];
                    var tabell = '';
                    $.each(stat, function(key, value){
                        list.push(value.Aldersklass);
                        areal.push(value.Areal);
                        farg.push(value.FillColor)
                        //till tabell
                        tabell += '<tr>';
                        tabell += '<td>' +value.Aldersklass+ '</td>'
                        tabell += '<td>' +value.Areal+ '</td>'
                        tabell += '<td>' +value.Volym+ '</td>'
                        tabell += '</tr>';

                    });
                    $('#alderTabell').append(tabell);
                    var ctx = document.getElementById(htmlCanvas);
                    var myChart = new Chart(ctx, {
                        //type: 'bar',
                        type: 'horizontalBar',
                        data: {
                            labels: list,
                            datasets: [
                                    { 
                                        data: areal,
                                        label: 'Areal',
                                        backgroundColor: farg,
                                        borderColor: "#000000",
                                        borderWidth: 1,
                                    }
                                    ]
                                }
                    });                
                }
                function makeAlderVolymBarDiagram(stat, htmlCanvas){
                    //Alderdiagram
                    var list = [];
                    var areal = [];
                    var farg = [];
                    var tabell = '';
                    $.each(stat, function(key, value){
                        list.push(value.Aldersklass);
                        areal.push(value.Volym);
                        farg.push(value.FillColor)
                    });
                    var ctx = document.getElementById(htmlCanvas);
                    var myChart = new Chart(ctx, {
                        //type: 'bar',
                        type: 'horizontalBar',
                        data: {
                            labels: list,
                            datasets: [
                                    { 
                                        data: areal,
                                        label: 'Volym',
                                        backgroundColor: farg,
                                        borderColor: "#000000",
                                        borderWidth: 1,
                                    }
                                    ]
                                }
                    });                
                }
            });

        });
            

    </script>
</body>
</html>

