<!DOCTYPE html>
<html>
    <head>
            <!-- skapad utifrån http://www.jessicaschillinger.us/2017/blog/print-repeating-header-browser/ -->
            <title>Planeringsunderlag försäljning</title>
            <meta charset="utf-8">
            <meta name="viewport" content="width=device-width, initial-scale=1">
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css">
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"></script>
            <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.min.js"></script>

            <!-- Leaflet -->
            <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ==" crossorigin=""/>
            <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js" integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw==" crossorigin=""></script>

            <!-- Load Esri Leaflet from CDN.  it has no .css stylesheet of its own, only .js -->
            <script src="https://unpkg.com/esri-leaflet@2.0.4/dist/esri-leaflet.js"></script>

            <!-- Laddar proj4 -->
            <script src="https://unpkg.com/proj4@2.4.3"></script>
            <script src="https://unpkg.com/proj4leaflet@1.0.1"></script>

            <style type="text/css">
                #mapid { height : 800px;}
            </style>
    </head>

<body>
    


    <div class="container">
            <div class="row pgaBreak" id="kartsida_3">
                    <div class="col">
                        <div class="jumbotron">
                            <div>
                                <img src="https://www.sveaskog.se/static/dist/img/sveaskog-logo.svg" alt="Sveaskog" style="padding:5px;" width="200px" align="left">    
                            </div>
                            <div>
                                <h1 align="center">Planeringsunderlag försäljning</h1>
                                <p align="center">Sveaskog säljer Lorem ipsum dolor sit amet con</p>    
                            </div>
                        </div>
                        <div>
                            <div id="mapid"></div> 
                        </div>
                    </div>
                </div>
    </div>





    <script>


//https://kartportal.sveaskog.se/portal/sharing/servers/5f1b259ea72b49aab68d7504a99c265b/rest/services/MetriaMapsOrto/MapServer

    var crs = new L.Proj.CRS('EPSG:3006',
        '+proj=utm +zone=33 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs',
        {
            resolutions: [
                8192, 4096, 2048, 1024, 512, 256, 128,
                64, 32, 16, 8, 4, 2, 1, 0.5
            ],
            origin: [0, 0],
            bounds: L.bounds([218128.7031, 6126002.9379], [1083427.2970, 7692850.9468])
        }),
        map = new L.Map('mapid', {
            crs: crs,
        });

    L.tileLayer('https://api.geosition.com/tile/osm-bright-3006/{z}/{x}/{y}.png', {
        maxZoom: 14,
        minZoom: 0,
        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap contributors</a>, Imagery &copy; <a href="http://www.kartena.se/">Kartena</a>'
    }).addTo(map);

    map.setView([57.704, 11.965], 13);


    //var url = "https://kartportal.sveaskog.se/portal/sharing/servers/5f1b259ea72b49aab68d7504a99c265b/rest/services/MetriaMapsOrto/MapServer";
    //ortoLayer = L.esri.imageMapLayer({
    //    url: url,
    //    //opacity : 0.25
    //    }).addTo(map);
    //console.log(ortoLayer);

    var wmsLayer = L.tileLayer.wms('https://kartportaltest.sveaskog.se/tokenproxy/metria/wms?', {
        layers: 'metria:orto_farg',
        maxZoom: 14
    }).addTo(map);


    
	// Create a popup to return clicked coordinates on the map
	var popup = L.popup();
	function onMapClick(e) {
		var swerefproj = "+proj=utm +zone=33 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs";
		var swerefcoords = proj4(swerefproj, [e.latlng.lng, e.latlng.lat]);
        console.log(swerefcoords);
        console.log(swerefcoords[0]);
        console.log(swerefcoords[1]);
		popup
			.setLatLng(e.latlng)
			.setContent("X: " + swerefcoords[0].toString().substring(0,6) + '<br/>' + "Y: " + swerefcoords[1].toString().substring(0,6))
			.openOn(map);
	};
	map.on('click', onMapClick);

    </script>
</body>
</html>

